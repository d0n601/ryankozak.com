I"E<p>I’ve been playing a lot of CTFs this summer. My goal was obviously to brush up on my offensive security skills, but also to practice doing security writeups. I wanted to post the writeups on my blog and publish them as PDFs. Writing the whole thing in a document editor is miserable, I hate using document editors. Then doing the whole thing again as a blog post just means even more work. So, here’s the workflow I developed this summer to do my writeups once using markdown, and easily publish in both formats.</p>

<p>Here is the github repo for the my <a href="https://github.com/d0n601/HTB_Writeup-Template">HTB Writeup Template</a>.</p>

<h2 id="installation-on-ubuntu">Installation on Ubuntu</h2>
<p><em>Note: If you use Debian or Mint it may work but your mileage here might vary.</em></p>

<ol>
  <li>Install <a href="https://www.latex-project.org/">Latex</a> via <code class="language-plaintext highlighter-rouge">sudo apt-get install texlive</code>.</li>
  <li>Install <a href="https://pandoc.org/">Pandoc</a> via <code class="language-plaintext highlighter-rouge">sudo apt-get install pandoc</code>.</li>
  <li>Install the <a href="https://github.com/Wandmalfarbe/pandoc-latex-template">Pandoc Latex Template</a>
    <ul>
      <li>Download the latest version of the Eisvogel template from the <a href="https://github.com/Wandmalfarbe/pandoc-latex-template/releases/latest">release page</a>.</li>
      <li>Extract the <code class="language-plaintext highlighter-rouge">tar.gz</code> archive and open the folder.</li>
      <li>Create a pandoc templates folder if it doesn’t exist at <code class="language-plaintext highlighter-rouge">~/.pandoc/templates/</code>.</li>
      <li>Move the template <code class="language-plaintext highlighter-rouge">eisvogel.tex</code> to your pandoc templates folder and rename the file to <code class="language-plaintext highlighter-rouge">eisvogel.latex</code>.</li>
    </ul>
  </li>
  <li>Make sure you have <a href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/">PDFtk</a> installed via <code class="language-plaintext highlighter-rouge">sudo apt-get install pdftk</code>.</li>
</ol>

<h2 id="usage">Usage</h2>
<p>Initially I publish my writeups as a password protected pdf, the password set to the root flag for the box. After the box is retired, I post the writeup on my Jekyll site.</p>

<p>Here’s the directory structure for my writeup <a href="https://github.com/d0n601/HTB_Writeup-Template">template</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTB_Writeup-TEMPLATE
│   HTB_Writeup-TEMPLATE-d0n601.md   
│
└───pdf
│   │   HTB_Writeup-TEMPLATE-d0n601.pdf
│   │
│   └───protected
│       │   HTB_Writeup-TEMPLATE-d0n601.pdf
│   
└───images
│       │   badge.png
│       │   someotherimage.png
│       │   ...
</code></pre></div></div>

<h3 id="markdown-for-pdf">Markdown for pdf</h3>
<p>In order to generate a pdf from markdown using pandoc we must format the header correctly. The header for my template is as follows.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
title: "Hack The Box - BOX NAME HERE"
author: Ryan Kozak
date: "2019-08-11"
subject: "CTF Writeup Template"
keywords: [HTB, CTF, Hack The Box, Security]
lang: "en"
titlepage: true
titlepage-text-color: "FFFFFF"
titlepage-color: "0c0d0e"
titlepage-rule-color: "8ac53e"
logo: "./images/badge.png"
logo-width: 350
...
</code></pre></div></div>

<p>See my example markdown <a href="https://raw.githubusercontent.com/d0n601/HTB_Writeup-Template/master/HTB_Writeup-TEMPLATE-d0n601.md?token=ACEL5KMOWDBZXMQ7QT2OK725LGTY4">here</a>.</p>

<p>Once the writeup is complete, or you’re just looking to build it to see how it’s looking as a pdf, issue the following command from your writeup directory.</p>

<p><code class="language-plaintext highlighter-rouge">pandoc --latex-engine=xelatex ./HTB_Writeup-TEMPLATE-d0n601.md -o ./pdf/HTB_Writeup-TEMPLATE-d0n601.pdf --from markdown --template eisvogel --listings</code></p>

<p>See the full pdf example <a href="https://github.com/d0n601/HTB_Writeup-Template/blob/master/pdf/HTB_Writeup-TEMPLATE-d0n601.pdf">here</a>.</p>

<h3 id="password-protect-pdf">Password Protect pdf</h3>
<p>Once the writeup is complete and ready to publish, it should be protected with the root flag so it doesn’t violate <a href="https://hackthebox.eu">Hack The Box</a> rules, allow people to cheat, and generally spoil the fun.</p>

<p>To password protect the pdf I use <code class="language-plaintext highlighter-rouge">pdftk</code>. From the root folder of the writup directory issue the following command.</p>

<p><code class="language-plaintext highlighter-rouge">pdftk ./pdf/HTB_Writeup-TEMPLATE-d0n601.pdf output ./pdf/protected/HTB_Writeup-TEMPLATE-d0n601.pdf user_pw v5gw5zkh8rr3vmye7p4ka</code></p>

<p>Now a password protected pdf will appear in the <code class="language-plaintext highlighter-rouge">/pdf/protected</code> directory.</p>

<p>See the password protected pdf example <a href="https://github.com/d0n601/HTB_Writeup-Template/blob/master/pdf/protected/HTB_Writeup-TEMPLATE-d0n601.pdf">here</a>.</p>

<h3 id="jekyll-blog">Jekyll Blog</h3>
<p>When the writeup is ready to be made public there are a few adjustments to be made to the markdown in order to make it a Jekyll post. The first thing that must change is the header. Remove the older header used by pandoc and replace it with something like the following.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
title: "Hack The Box - Example Writeup"
author: Ryan Kozak
layout: post
description: Here is an example post of a Hack The Box writeup.
permalink: /hack-the-box-example-writeup/
categories:
  - Random
tags:
  - pandoc
  - markdown
  - latex
  - ctf
---
</code></pre></div></div>

<p>The next change after that is placing the images into the blog’s image directory redoing the links to reference wherever they’re at on your Jekyll site. Lastly you need to modify the captions, because they’re specific to pandoc and don’t look pretty in markdown.</p>

<p>So this which was an image and caption on the pdf,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![My Website](./images/ryankozak.com.png)
\ **Figure 1:** My Website
</code></pre></div></div>

<p>Becomes this on the Jekyll post.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![My Website](/wp-content/uploads/2019/08/template/images/ryankozak.com.png)
**Figure 1:** My Website
</code></pre></div></div>

<p>Now we’re done. Here is the example writeup from the pdf you’ve seen converted to a blog post <a href="https://ryankozak.com/hack-the-box-example-writeup/">https://ryankozak.com/hack-the-box-example-writeup/</a></p>

<p>For more information on modifying the template, please see the <a href="https://github.com/Wandmalfarbe/pandoc-latex-template">Pandoc Latex Template’s Repo</a>. Its usage section will tell you all about the custom template variables, as well as provide you with some examples.</p>

<h1 id="conclusion">Conclusion</h1>
<p>The easier you can make doing a writeup, generally the more prone you’ll be to actually do them. I’ve found this workflow to be very efficient and enjoyable.</p>
:ET